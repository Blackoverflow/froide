!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.publicbody=t():(e.Froide=e.Froide||{},e.Froide.components=e.Froide.components||{},e.Froide.components.publicbody=t())}(window,function(){return function(e){function t(t){for(var n,u,c=t[0],o=t[1],a=t[2],d=0,f=[];d<c.length;d++)u=c[d],r[u]&&f.push(r[u][0]),r[u]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(l&&l(t);f.length;)f.shift()();return i.push.apply(i,a||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],n=!0,c=1;c<s.length;c++){var o=s[c];0!==r[o]&&(n=!1)}n&&(i.splice(t--,1),e=u(u.s=s[0]))}return e}var n={},r={2:0},i=[];function u(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,u),s.l=!0,s.exports}u.m=e,u.c=n,u.d=function(e,t,s){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(u.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(s,n,function(t){return e[t]}.bind(null,n));return s},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="";var c=window.webpackJsonp=window.webpackJsonp||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var a=0;a<c.length;a++)t(c[a]);var l=o;return i.push([144,0]),s()}({10:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(s(6)),r=i(s(4));function i(e){return e&&e.__esModule?e:{default:e}}t.default={name:"pb-result-list",props:["name","scope","config"],mixins:[n.default,r.default],computed:{value:{get:function(){if(this.publicBody)return this.publicBody.id},set:function(e){this.setPublicBody({publicBody:this.getPublicBody(e),scope:this.scope}),this.clearSearchResults({scope:this.scope})}}},methods:{selectSearchResult:function(e){this.value=e.target.value}}}},11:function(e,t,s){},12:function(e,t,s){"use strict";s.r(t);var n=s(13),r=s.n(n);for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);t.default=r.a},13:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(1),i=s(2),u=o(s(6)),c=o(s(4));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"pb-action-list",mixins:[u.default,c.default],props:["name","scope","config"],methods:n({selectSearchResult:function(e){this.setPublicBodyId({publicBodyId:e,scope:this.scope}),this.setStepRequest()},getMakeRequestURLForResult:function(e){return this.config.url.makeRequestTo.replace(/0/,e.id)}},(0,r.mapMutations)({setStepRequest:i.SET_STEP_REQUEST,setPublicBodyId:i.SET_PUBLICBODY_ID}))}},14:function(e,t,s){},144:function(e,t,s){e.exports=s(145)},145:function(e,t,s){"use strict";var n=o(s(20)),r=o(s(87)),i=s(2),u=s(31),c=o(s(89));function o(e){return e&&e.__esModule?e:{default:e}}function a(e){r.default.commit(i.SET_CONFIG),new n.default({store:r.default,components:{PublicbodyChooser:c.default},render:(0,u.renderComponent)(e,c.default)}).$mount(e)}n.default.config.productionTip=!1;for(var l=document.querySelectorAll(".publicbody-chooser"),d=0;d<l.length;d+=1)a(l[d])},15:function(e,t,s){"use strict";s.r(t);var n=s(16),r=s.n(n);for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);t.default=r.a},16:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(1),i=s(2),u=a(s(6)),c=a(s(4)),o=a(s(97));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"pb-multi-list",props:["name","scope","config"],mixins:[u.default,c.default],methods:n({selectAll:function(){var e=this;this.searchResults.forEach(function(t){e.addPublicBodyId({publicBodyId:t.id,scope:e.scope})})}},(0,r.mapMutations)({setStepRequest:i.SET_STEP_REQUEST,addPublicBodyId:i.ADD_PUBLICBODY_ID})),components:{PbMultiItem:o.default}}},17:function(e,t,s){"use strict";s.r(t);var n=s(18),r=s.n(n);for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);t.default=r.a},18:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(1),i=s(2);t.default={name:"pb-multi-item",props:["name","result","scope"],computed:n({value:{get:function(){return this.isPublicBodySelectedByScope(this.scope,this.result.id)},set:function(e){e?this.addPublicBodyId({publicBodyId:this.result.id,scope:this.scope}):this.removePublicBodyId({publicBodyId:this.result.id,scope:this.scope})}}},(0,r.mapGetters)(["isPublicBodySelectedByScope"])),methods:n({selectSearchResult:function(e){this.value=e.target.value}},(0,r.mapMutations)({addPublicBodyId:i.ADD_PUBLICBODY_ID,removePublicBodyId:i.REMOVE_PUBLICBODY_ID}))}},19:function(e,t,s){},2:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SET_CONFIG="SET_CONFIG",t.SET_STEP="SET_STEP",t.SET_STEP_SELECT_PUBLICBODY="SET_STEP_SELECT_PUBLICBODY",t.SET_STEP_REVIEW_PUBLICBODY="SET_STEP_REVIEW_PUBLICBODY",t.SET_STEP_REQUEST="SET_STEP_REQUEST",t.SET_STEP_BY_URL="SET_STEP_BY_URL",t.SET_PUBLICBODY="SET_PUBLICBODY",t.SET_PUBLICBODY_ID="SET_PUBLICBODY_ID",t.ADD_PUBLICBODY_ID="ADD_PUBLICBODY_ID",t.REMOVE_PUBLICBODY_ID="REMOVE_PUBLICBODY_ID",t.CLEAR_PUBLICBODIES="CLEAR_PUBLICBODIES",t.SET_PUBLICBODIES="SET_PUBLICBODIES",t.CACHE_PUBLICBODIES="CACHE_PUBLICBODIES",t.CACHE_LAWS="CACHE_LAWS",t.UPDATE_LAW_TYPE="UPDATE_LAW_TYPE",t.SET_SEARCHRESULTS="SET_SEARCHRESULTS",t.CLEAR_SEARCHRESULTS="CLEAR_SEARCHRESULTS",t.UPDATE_SUBJECT="UPDATE_SUBJECT",t.UPDATE_BODY="UPDATE_BODY",t.UPDATE_FULL_TEXT="UPDATE_FULL_TEXT",t.SET_USER="SET_USER",t.UPDATE_FIRST_NAME="UPDATE_FIRST_NAME",t.UPDATE_LAST_NAME="UPDATE_LAST_NAME",t.UPDATE_EMAIL="UPDATE_EMAIL",t.UPDATE_ADDRESS="UPDATE_ADDRESS",t.UPDATE_PRIVATE="UPDATE_PRIVATE",t.UPDATE_USER_ID="UPDATE_USER_ID",t.STEPS={SELECT_PUBLICBODY:1,REVIEW_PUBLICBODY:2,WRITE_REQUEST:3}},23:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.publicBody&&!e.hasSearchResults?s("div",{staticClass:"search-result"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"radio","data-label":e.publicBody.name,name:e.name},domProps:{value:e.publicBody.id,checked:e._q(e.value,e.publicBody.id)},on:{change:function(t){e.value=e.publicBody.id}}}),e._v("\n      "+e._s(e.publicBody.name)+"\n      "),s("small",[e._v("\n        "+e._s(e.publicBody.jurisdiction.name)+"\n      ")])])]):e._e(),e._v(" "),e.searchResults.length>0||e.emptyResults?s("ul",{staticClass:"search-results list-unstyled"},e._l(e.searchResults,function(t){return s("li",{key:t.id,staticClass:"search-result"},[s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"radio","data-label":t.name,name:e.name},domProps:{value:t.id,checked:e._q(e.value,t.id)},on:{change:[function(s){e.value=t.id},e.selectSearchResult],click:e.selectSearchResult}}),e._v("\n        "+e._s(t.name)+"\n        "),s("small",[e._v("\n          "+e._s(t.jurisdiction.name)+"\n        ")])])])})):e._e()])},r=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return r})},24:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.searchResults.length>0||e.emptyResults?s("div",[s("div",[s("a",{directives:[{name:"show",rawName:"v-show",value:e.hasPublicBodies,expression:"hasPublicBodies"}],staticClass:"btn btn-primary",attrs:{href:"#step-request"},on:{click:e.setStepRequest}},[e._v("\n        Continue\n      ")]),e._v(" "),e.hasSearchResults?s("a",{staticClass:"btn btn-light pull-right",attrs:{href:"#"},on:{click:e.selectAll}},[e._v("\n        Select all\n      ")]):e._e()]),e._v(" "),s("ul",{staticClass:"search-results list-unstyled"},e._l(e.searchResults,function(t){return s("li",{key:t.id,staticClass:"search-result"},[s("pb-multi-item",{attrs:{name:e.name,result:t,scope:e.scope}})],1)})),e._v(" "),e.hasPublicBodies?s("p",[s("a",{staticClass:"btn btn-primary",attrs:{href:"#step-request"},on:{click:e.setStepRequest}},[e._v("\n        Continue\n      ")])]):e._e()]):e._e()])},r=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return r})},25:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-result-container"},[e.searchResultsLength>0||e.emptyResults?s("ul",{staticClass:"search-results list-unstyled"},e._l(e.searchResults,function(t){return s("li",{key:t.id,staticClass:"search-result",on:{click:function(s){s.preventDefault(),e.selectSearchResult(t.id)}}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-8"},[s("h4",{staticClass:"pb-heading"},[e._v("\n            "+e._s(t.name)+"\n          ")]),e._v(" "),s("small",[e._v("\n            "+e._s(t.jurisdiction.name)+",\n            "+e._s(e.i18n._("requestCount",{count:t.number_of_requests}))+"\n          ")])]),e._v(" "),s("div",{staticClass:"col-sm-4"},[s("a",{staticClass:"btn btn-primary",attrs:{href:e.getMakeRequestURLForResult(t)},on:{click:function(s){s.preventDefault(),e.selectSearchResult(t.id)}}},[e._v("\n            "+e._s(e.i18n.makeRequest)+"\n          ")])])])])})):e._e(),e._v(" "),e.hasSearchResults&&e.maxResultPage>1?s("ul",{staticClass:"pagination"},[e.hasPreviousSearchResults?s("li",{staticClass:"page-item"},[s("a",{staticClass:"page-link prev",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.getPrevious(t)}}},[s("span",{attrs:{"aria-hidden":"true"}},[e._v("«")]),e._v(" "),s("span",{staticClass:"sr-only"},[e._v(e._s(e.i18n.previous))])])]):s("li",{staticClass:"page-item disabled"},[s("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1"}},[s("span",{attrs:{"aria-hidden":"true"}},[e._v("«")]),e._v(" "),s("span",{staticClass:"sr-only"},[e._v(e._s(e.i18n.previous))])])]),e._v(" "),s("li",{staticClass:"page-item disabled"},[s("span",{staticClass:"page-link"},[e._v("\n        "+e._s(e.currentResultPage)+" / "+e._s(e.maxResultPage)+"\n      ")])]),e._v(" "),e.hasNextSearchResults?s("li",{staticClass:"page-item"},[s("a",{staticClass:"page-link next",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.getNext(t)}}},[s("span",{attrs:{"aria-hidden":"true"}},[e._v("»")]),e._v(" "),s("span",{staticClass:"sr-only"},[e._v(e._s(e.i18n.next))])])]):s("li",{staticClass:"page-item disabled"},[s("a",{staticClass:"page-link",attrs:{href:"#",tabindex:"-1"}},[s("span",{staticClass:"sr-only"},[e._v(e._s(e.i18n.next))]),e._v(" "),s("span",{attrs:{"aria-hidden":"true"}},[e._v("»")])])])]):e._e()])},r=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return r})},26:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"publicbody-chooser mb-3"},[s("div",{staticClass:"form-search"},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"search-public_bodies form-control",attrs:{type:"search",placeholder:e.i18n.publicBodySearchPlaceholder},domProps:{value:e.search},on:{keyup:e.triggerAutocomplete,keydown:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?(t.preventDefault(),e.triggerAutocomplete(t)):null},input:function(t){t.target.composing||(e.search=t.target.value)}}}),e._v(" "),s("div",{staticClass:"input-group-append"},[s("button",{staticClass:"btn btn-primary search-public_bodies-submit",attrs:{type:"button"},on:{click:e.triggerAutocomplete}},[s("i",{staticClass:"fa fa-search"}),e._v("\n          "+e._s(e.i18n.search)+"\n        ")])])])]),e._v(" "),e.searching?s("div",{staticClass:"search-spinner"},[s("img",{attrs:{src:e.config.resources.spinner,alt:"Loading..."}})]):e._e(),e._v(" "),s(e.getListView,{tag:"component",attrs:{name:e.name,scope:e.scope,config:e.config}})],1)},r=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return r})},27:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{type:"checkbox","data-label":e.result.name,name:e.name},domProps:{value:e.result.id,checked:Array.isArray(e.value)?e._i(e.value,e.result.id)>-1:e.value},on:{change:function(t){var s=e.value,n=t.target,r=!!n.checked;if(Array.isArray(s)){var i=e.result.id,u=e._i(s,i);n.checked?u<0&&(e.value=s.concat([i])):u>-1&&(e.value=s.slice(0,u).concat(s.slice(u+1)))}else e.value=r}}}),e._v("\n  "+e._s(e.result.name)+"\n  "),s("small",[e._v("\n    "+e._s(e.result.jurisdiction.name)+"\n  ")])])},r=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return r})},29:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t}return n(e,[{key:"getJson",value:function(e){return new Promise(function(t,s){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){if(n.status>=400)try{return s(JSON.parse(n.responseText))}catch(e){return s(n.responseText)}t(JSON.parse(n.responseText))},n.onerror=function(){s(n.statusText)},n.send()})}},{key:"getObjects",value:function(e){return new Promise(function(t,s){e.then(function(e){return t(e.objects)}).catch(function(e){return s(e)})})}},{key:"getJsonObjects",value:function(e){var t=this;return new Promise(function(s,n){t.getJson(e).then(function(e){return s(e.objects)}).catch(function(e){return n(e)})})}},{key:"getPublicBody",value:function(e){var t=this.config.url.getPublicBody.replace(/\/0\//,"/"+e+"/");return this.getJson(t)}},{key:"autocompletePublicBody",value:function(e){var t=encodeURIComponent(e),s=this.config.url.autocompletePublicBody+"?query="+t;return this.getJsonObjects(s)}},{key:"getUser",value:function(){return this.getJson(this.config.url.user)}},{key:"getJsonForUrl",value:function(e,t,s){var n=!1;return void 0!==t&&t&&(n=!0,e=e+"?q="+encodeURIComponent(t)),void 0!==s&&function(){var t=[],r=function(e){var n=s[e];null!==n&&(Array.isArray(n)||(n=[n]),n.forEach(function(s){t.push(e+"="+encodeURIComponent(s))}))};for(var i in s)r(i);e+=n?"&":"?",e+=t.join("&")}(),this.getJson(e)}},{key:"searchPublicBodies",value:function(e,t){return this.getJsonForUrl(this.config.url.searchPublicBody,e,t)}},{key:"listPublicBodies",value:function(e,t){return this.getJsonForUrl(this.config.url.listPublicBodies,e,t)}},{key:"getLawsForPublicBodies",value:function(e,t){t=t||{};var s={},n=[];return e.forEach(function(e){e.laws.forEach(function(e){if("string"==typeof e){if(void 0!==t[e])return;var r=e.split("/"),i=r[r.length-2];void 0===s[i]&&(s[i]=!0,n.push(i))}})}),0===n.length?Promise.resolve([]):this.getJsonForUrl(this.config.url.listLaws,null,{id:n.join(",")}).then(function(e){return e.objects})}},{key:"listJurisdictions",value:function(e,t){return this.getJsonForUrl(this.config.url.listJurisdictions,e,t)}},{key:"listCategories",value:function(e,t){return this.getJsonForUrl(this.config.url.listCategories,e,t)}},{key:"listClassifications",value:function(e,t){return this.getJsonForUrl(this.config.url.listClassifications,e,t)}},{key:"searchFoiRequests",value:function(e){var t=encodeURIComponent(e),s=this.config.url.searchRequests+"?q="+t;return this.getJsonObjects(s)}}]),e}();t.FroideAPI=r},31:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e};function r(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}function i(e,t){return function(){return t(e.tag,{domProps:{innerHTML:e.innerHTML}})}}t.renderComponent=function(e,t){"string"==typeof e&&(e=document.querySelector(e));var s=function(e){for(var t=e.attributes,s={},n=0;n<t.length;n+=1){var i=t[n];if(("v"!==i.name[0]||"-"!==i.name[1])&&"id"!==i.name&&"class"!==i.name){var u=i.value,c=i.name;":"===i.name[0]&&(c=i.name.substring(1),"{"!==i.value[0]&&"["!==i.value[0]||(u=JSON.parse(i.value)),"true"===i.value&&(u=!0)),s[r(c)]=u}}return s}(e),u=function(e){for(var t=e.querySelectorAll("[slot]"),s={},n=0;n<t.length;n+=1){var r=t[n];s[r.attributes.slot.value]={tag:r.tagName.toLowerCase(),innerHTML:r.innerHTML}}return s}(e),c=function(e){var t={};if(e.id&&(t.attrs={id:e.id}),e.className){var s=e.className.split(" ");t.class={},s.forEach(function(e){t.class[e.trim()]=!0})}return t}(e);return function(e){var r=function(e,t){var s={};for(var n in e)s[n]=i(e[n],t);return s}(u,e);return e(t,n({props:s,scopedSlots:r},c))}}},32:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(30),i=s(1),u=s(2),c={created:function(){if(this.hasForm&&this.field.value){var e=this.field.objects;this.cachePublicBodies(e),this.setPublicBodies({publicBodies:e,scope:this.scope})}},computed:n({help_url:function(){return this.config.url.helpAbout},headers:function(){return[{key:"name",label:this.i18n.name,sortKey:function(e){return e.name}},{key:"jurisdiction",label:this.i18n.jurisdictionPlural[0],sortKey:function(e){return e.jurisdiction.name}},{key:"classification",label:this.i18n.classificationPlural[0],sortKey:function(e){return e.classification&&e.classification.name}},{key:"categories",label:this.i18n.topicPlural[1],sortKey:function(e){return e.categories[0]&&e.categories[0].name}}]},hasForm:function(){return void 0!==this.form&&null!==this.form&&""!==this.form},formFields:function(){return this.form.fields},field:function(){return this.formFields[this.name]},errors:function(){return this.form.errors},hasPublicBodies:function(){return this.publicBodies.length>0},debouncedAutocomplete:function(){return(0,r.debounce)(this.runAutocomplete,300)},hasFilters:function(){return!!this.filters&&Object.keys(this.filters).length>0},searchFilters:function(){var e={};if(!this.hasFilters)return e;for(var t in this.filters)null!==this.filters[t]&&0!==this.filters[t].length&&(e[t]=this.filters[t].id);return e},hasSearchResults:function(){return this.searchResults.length>0},searchResults:function(){return this.getScopedSearchResults(this.scope)},searchMeta:function(){return this.getScopedSearchMeta(this.scope)}},(0,i.mapGetters)(["getPublicBodyByScope","getScopedSearchResults","getScopedSearchMeta"])),methods:n({buildQuery:function(){var e=this.search;return this.hasFilters&&(e+=JSON.stringify(this.filters)),e},selectAllRows:function(e){var t=this;this.searchResults.forEach(function(s){e?t.addPublicBodyId({publicBodyId:s.id,scope:t.scope}):t.removePublicBodyId({publicBodyId:s.id,scope:t.scope})})},clearSelection:function(){window.confirm(this.i18n.reallyClearSelection)&&(this.clearPublicBodies({scope:this.scope}),this.setStepSelectPublicBody())},triggerAutocomplete:function(){(""!==this.search||this.hasFilters||(this.searching=!1),!this.allowEmptySearch&&void 0!==this.search&&this.search.length<3&&!this.hasFilters)?this.searching=!1:this.buildQuery()!==this.lastQuery||0===this.searchResults.length?(this.searching=!0,this.debouncedAutocomplete()):this.searching=!1},runAutocomplete:function(){var e=this;return this.searching=!0,this.lastQuery=this.buildQuery(),this.getSearchResults({scope:this.scope,search:this.search,filters:this.searchFilters}).then(function(){e.searching=!1})},clearResults:function(){this.clearSearchResults({scope:this.scope})}},(0,i.mapMutations)({setPublicBody:u.SET_PUBLICBODY,setPublicBodies:u.SET_PUBLICBODIES,setSearchResults:u.SET_SEARCHRESULTS,cachePublicBodies:u.CACHE_PUBLICBODIES,clearPublicBodies:u.CLEAR_PUBLICBODIES,clearSearchResults:u.CLEAR_SEARCHRESULTS,addPublicBodyId:u.ADD_PUBLICBODY_ID,setStepSelectPublicBody:u.SET_STEP_SELECT_PUBLICBODY,removePublicBodyId:u.REMOVE_PUBLICBODY_ID}),(0,i.mapActions)(["getSearchResults"]))};t.default=c},4:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=new RegExp(/\$\{(\w+)\}/g),i=document.querySelector("html").lang,u={computed:{i18n:function(){return n({_replacer:function(e){return function(t,s,n,r){return"count"===s&&e.count>=1e3?e.count.toLocaleString(i):e[s]}},_:function(e,t){var s=this[e];return Array.isArray(s)?void 0!==t.count&&(t.count>1||0===t.count)?s[1].replace(r,this._replacer(t)):s[0].replace(r,this._replacer(t)):s.replace(r,this._replacer(t))}},this.config.i18n)}}};t.default=u},6:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(1),i=s(2),u={computed:n({publicBody:function(){return this.getPublicBodyByScope(this.scope)},publicBodies:function(){return this.getPublicBodiesByScope(this.scope)},hasPublicBodies:function(){return this.publicBodies.length>0},searchResults:function(){return this.getScopedSearchResults(this.scope)},hasSearchResults:function(){return this.searchResults.length>0},hasNextSearchResults:function(){var e=this.getScopedSearchMeta(this.scope);return!!e&&e.next},hasPreviousSearchResults:function(){var e=this.getScopedSearchMeta(this.scope);return!!e&&e.previous},currentResultPage:function(){var e=this.getScopedSearchMeta(this.scope);return e?e.offset/e.limit+1:0},maxResultPage:function(){var e=this.getScopedSearchMeta(this.scope);return e?Math.ceil(e.total_count/e.limit):0},currentResultsLength:function(){var e=this.searchResults;return e?e.length:null},searchResultsLength:function(){var e=this.getScopedSearchMeta(this.scope);return e?e.total_count:0},emptyResults:function(){var e=this.searchResultsLength;return null!==e&&0===e}},(0,r.mapGetters)(["getPublicBody","getPublicBodyByScope","getPublicBodiesByScope","getScopedSearchResults","getScopedSearchMeta"])),methods:n({getNext:function(e){this.getNextSearchResults(this.scope)},getPrevious:function(e){this.getPreviousSearchResults(this.scope)}},(0,r.mapMutations)({setPublicBody:i.SET_PUBLICBODY,clearSearchResults:i.CLEAR_SEARCHRESULTS}),(0,r.mapActions)(["getNextSearchResults","getPreviousSearchResults"]))};t.default=u},7:function(e,t,s){"use strict";s.r(t);var n=s(8),r=s.n(n);for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);t.default=r.a},8:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},r=s(1),i=d(s(90)),u=d(s(93)),c=d(s(96)),o=d(s(32)),a=d(s(4)),l=s(2);function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"publicbody-chooser",mixins:[o.default,a.default],props:["name","scope","defaultsearch","form","config","listView"],data:function(){return{search:this.defaultsearch,lastQuery:null,emptyResults:!1,searching:!1}},created:function(){this.setConfig(this.config)},mounted:function(){this.defaultsearch&&null===this.searchMeta&&this.triggerAutocomplete()},components:{resultList:i.default,actionList:u.default,multi:c.default},computed:{getListView:function(){return this.listView?this.listView:"resultList"},label:function(){if(this.publicBody)return this.publicBody.name},publicBody:function(){return this.getPublicBodyByScope(this.scope)}},methods:n({},(0,r.mapMutations)({setConfig:l.SET_CONFIG}))}},87:function(e,t,s){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},i=l(s(20)),u=l(s(1)),c=s(2),o=s(29),a=s(88);function l(e){return e&&e.__esModule?e:{default:e}}function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}i.default.use(u.default);t.default=new u.default.Store({state:{config:null,scopedSearchResults:{},scopedSearchFacets:{},scopedSearchMeta:{},scopedPublicBodies:{},scopedPublicBodiesMap:{},lawCache:{},publicBodies:{},lawType:null,user:{},step:c.STEPS.SELECT_PUBLICBODY,subject:"",body:"",fullText:!1},getters:{getPublicBodyByScope:function(e,t){return function(e){var s=t.getPublicBodiesByScope(e);return 0===s.length?null:s[0]}},getPublicBodiesByScope:function(e,t){return function(t){var s=e.scopedPublicBodies[t];return void 0===s?[]:s}},isPublicBodySelectedByScope:function(e){return function(t,s){var n=e.scopedPublicBodiesMap[t];return void 0!==n&&void 0!==n[s]}},getPublicBody:function(e){return function(t){return e.publicBodies[t]}},getScopedSearchResults:function(e,t){return function(t){var s=e.scopedSearchResults[t];return void 0===s?[]:s}},getScopedSearchFacets:function(e){return function(t){var s=e.scopedSearchFacets[t];return void 0===s?null:s}},getScopedSearchMeta:function(e){return function(t){var s=e.scopedSearchMeta[t];return void 0===s?null:s}},getLawsForPublicBody:function(e){return function(t){return t.laws.map(function(t){return e.lawCache[t]}).filter(function(e){return void 0!==e})}},defaultLaw:function(e,t){var s=null;for(s in e.scopedPublicBodies);for(var n=e.scopedPublicBodies[s],r=null,i=!0,u=0;u<n.length;u+=1){var c=n[u],o=t.getLawsForPublicBody(c),l=(0,a.selectBestLaw)(o,e.lawType);if(null!==l)if(0!==u){if(r.id!==l.id){i=!1;break}r=l}else r=l}return i?r:null},user:function(e){return e.user},subject:function(e){return e.subject},getSubject:function(e){return function(){return e.subject}},body:function(e){return e.body},fullText:function(e){return e.fullText},stepSelectPublicBody:function(e){return e.step===c.STEPS.SELECT_PUBLICBODY},stepSelectPublicBodyDone:function(e){return e.step>c.STEPS.SELECT_PUBLICBODY},stepReviewPublicBodies:function(e){return e.step===c.STEPS.REVIEW_PUBLICBODY},stepReviewPublicBodiesDone:function(e){return e.step>c.STEPS.REVIEW_PUBLICBODY},stepWriteRequest:function(e){return e.step===c.STEPS.WRITE_REQUEST},stepWriteRequestDone:function(e){return e.step>c.STEPS.WRITE_REQUEST},step:function(e){return e.step},lawType:function(e){return e.lawType}},mutations:(n={},d(n,c.SET_CONFIG,function(e,t){null!==e.config&&void 0!==e.config||(e.config=t)}),d(n,c.SET_STEP,function(e,t){e.step=t}),d(n,c.SET_STEP_SELECT_PUBLICBODY,function(e){e.step=c.STEPS.SELECT_PUBLICBODY}),d(n,c.SET_STEP_REVIEW_PUBLICBODY,function(e){e.step=c.STEPS.REVIEW_PUBLICBODY}),d(n,c.SET_STEP_REQUEST,function(e){e.step=c.STEPS.WRITE_REQUEST}),d(n,c.SET_PUBLICBODY,function(e,t){var s=t.publicBody,n=t.scope;i.default.set(e.scopedPublicBodies,n,[s]),i.default.set(e.scopedPublicBodiesMap,n,d({},s.id,!0)),e.scopedSearchResults[n].forEach(function(e){e.id===s.id?e.isSelected=!0:e.isSelected=!1})}),d(n,c.SET_PUBLICBODIES,function(e,t){var s=t.publicBodies,n=t.scope;i.default.set(e.scopedPublicBodies,n,s);var r={};s.forEach(function(e){r[e.id]=!0}),i.default.set(e.scopedPublicBodiesMap,n,r),e.scopedSearchResults[n]&&e.scopedSearchResults[n].forEach(function(e){void 0!==r[e.id]?e.isSelected=!0:e.isSelected=!1})}),d(n,c.SET_PUBLICBODY_ID,function(e,t){var s=t.publicBodyId,n=t.scope,r=e.publicBodies[s];i.default.set(e.scopedPublicBodies,n,[r]),i.default.set(e.scopedPublicBodiesMap,n,{publicBodyId:!0}),e.scopedSearchResults[n]&&e.scopedSearchResults[n].forEach(function(e){e.id===s?e.isSelected=!0:e.isSelected=!1})}),d(n,c.ADD_PUBLICBODY_ID,function(e,t){var s=t.publicBodyId,n=t.scope,r=e.publicBodies[s];if(void 0!==r){var u=e.scopedPublicBodies[n];if(void 0===u)i.default.set(e.scopedPublicBodies,n,[r]);else u.some(function(e){return e.id===r.id})||i.default.set(e.scopedPublicBodies,n,[].concat(function(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}(u),[r]));i.default.set(e.scopedPublicBodiesMap[n],s,!0),e.scopedSearchResults[n]&&e.scopedSearchResults[n].forEach(function(e){e.id===s&&(e.isSelected=!0)})}}),d(n,c.REMOVE_PUBLICBODY_ID,function(e,t){var s=t.publicBodyId,n=t.scope,r=e.scopedPublicBodies[n];void 0!==r&&(r=r.filter(function(e){return e.id!==s}),i.default.set(e.scopedPublicBodies,n,r),i.default.set(e.scopedPublicBodiesMap[n],s,void 0),e.scopedSearchResults[n]&&e.scopedSearchResults[n].forEach(function(e){e.id===s&&(e.isSelected=!1)}))}),d(n,c.CLEAR_PUBLICBODIES,function(e,t){var s=t.scope;i.default.set(e.scopedPublicBodies,s,[]),i.default.set(e.scopedPublicBodiesMap,s,{}),e.scopedSearchResults[s]&&e.scopedSearchResults[s].forEach(function(e){e.isSelected=!1})}),d(n,c.CACHE_PUBLICBODIES,function(e,t){var s={};t.forEach(function(e){s[e.id]=e}),e.publicBodies=r({},e.publicBodies,s)}),d(n,c.SET_SEARCHRESULTS,function(e,t){var s=t.searchResults,n=t.searchFacets,r=t.searchMeta,u=t.scope;s=s.map(function(t){return t.isSelected=void 0!==e.scopedPublicBodiesMap[u][t.id],t}),i.default.set(e.scopedSearchResults,u,s),i.default.set(e.scopedSearchFacets,u,n),i.default.set(e.scopedSearchMeta,u,r)}),d(n,c.CLEAR_SEARCHRESULTS,function(e,t){var s=t.scope;i.default.set(e.scopedSearchResults,s,[]),i.default.set(e.scopedSearchFacets,s,{}),i.default.set(e.scopedSearchMeta,s,null)}),d(n,c.UPDATE_FULL_TEXT,function(e,t){e.fullText=t}),d(n,c.SET_USER,function(e,t){e.user=t}),d(n,c.UPDATE_SUBJECT,function(e,t){e.subject=t}),d(n,c.UPDATE_BODY,function(e,t){e.body=t}),d(n,c.UPDATE_FIRST_NAME,function(e,t){i.default.set(e.user,"first_name",t)}),d(n,c.UPDATE_LAST_NAME,function(e,t){i.default.set(e.user,"last_name",t)}),d(n,c.UPDATE_ADDRESS,function(e,t){i.default.set(e.user,"address",t)}),d(n,c.UPDATE_EMAIL,function(e,t){i.default.set(e.user,"email",t)}),d(n,c.UPDATE_PRIVATE,function(e,t){i.default.set(e.user,"private",t)}),d(n,c.UPDATE_USER_ID,function(e,t){i.default.set(e.user,"id",t)}),d(n,c.UPDATE_LAW_TYPE,function(e,t){e.lawType=t}),d(n,c.CACHE_LAWS,function(e,t){t.laws.forEach(function(t){i.default.set(e.lawCache,t.resource_uri,t)})}),n),actions:{setSearchResults:function(e,t){var s=e.commit,n=(e.state,e.dispatch),r=t.scope,i=t.results;s(c.SET_SEARCHRESULTS,{searchResults:i.objects.results,searchFacets:i.objects.facets.fields,searchMeta:i.meta,scope:r}),s(c.CACHE_PUBLICBODIES,i.objects.results),n("getLawsForPublicBodies",i.objects.results)},cacheLaws:function(e,t){var s=e.commit,n=t.laws;s(c.CACHE_LAWS,{laws:n})},getLawsForPublicBodies:function(e,t){var s=e.state,n=e.dispatch;new o.FroideAPI(s.config).getLawsForPublicBodies(t,s.lawCache).then(function(e){n("cacheLaws",{laws:e})})},getSearchResults:function(e,t){var s=e.commit,n=e.state,r=e.dispatch,i=t.scope,u=t.search,a=t.filters;return s(c.CLEAR_SEARCHRESULTS,{scope:i}),new o.FroideAPI(n.config).searchPublicBodies(u,a).then(function(e){r("setSearchResults",{results:e,scope:i})})},setPublicBodyById:function(e,t){var s=e.state,n=e.dispatch,r=t.scope,i=t.id;return new o.FroideAPI(s.config).getPublicBody(i).then(function(e){n("setPublicBodyByIdDone",{result:e,scope:r,id:i})})},setPublicBodyByIdDone:function(e,t){var s=e.commit,n=e.dispatch,r=t.scope,i=t.result,u=t.id;s(c.CACHE_PUBLICBODIES,[i]),s(c.SET_PUBLICBODY_ID,{publicBodyId:u,scope:r}),s(c.SET_STEP_REQUEST),n("getLawsForPublicBodies",[i])},getSearchResultsUrl:function(e,t){var s=e.commit,n=e.state,r=(e.getters,e.dispatch),i=t.scope,u=t.url;return s(c.CLEAR_SEARCHRESULTS,{scope:i}),new o.FroideAPI(n.config).getJson(u).then(function(e){r("setSearchResults",{results:e,scope:i})})},getNextSearchResults:function(e,t){e.state;var s=e.getters;return(0,e.dispatch)("getSearchResultsUrl",{url:s.getScopedSearchMeta(t).next,scope:t})},getPreviousSearchResults:function(e,t){e.state;var s=e.getters;return(0,e.dispatch)("getSearchResultsUrl",{url:s.getScopedSearchMeta(t).previous,scope:t})}},strict:!1})},88:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return e.meta&&t.meta?0:e.meta?-1:t.meta?1:0};t.selectBestLaw=function(e,t){if(0===e.length)return null;var s=e.filter(function(e){return!t||e.law_type===t});return 0===s.length&&(s=[].concat(function(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}(e))),(s=s.sort(n))[0]}},89:function(e,t,s){"use strict";s.r(t);var n=s(26),r=s(7);for(var i in r)"default"!==i&&function(e){s.d(t,e,function(){return r[e]})}(i);var u=s(0),c=Object(u.a)(r.default,n.a,n.b,!1,null,null,null);c.options.__file="publicbody-chooser.vue",t.default=c.exports},9:function(e,t,s){"use strict";s.r(t);var n=s(10),r=s.n(n);for(var i in n)"default"!==i&&function(e){s.d(t,e,function(){return n[e]})}(i);t.default=r.a},90:function(e,t,s){"use strict";s.r(t);var n=s(23),r=s(9);for(var i in r)"default"!==i&&function(e){s.d(t,e,function(){return r[e]})}(i);s(91);var u=s(0),c=Object(u.a)(r.default,n.a,n.b,!1,null,"d39fe4f8",null);c.options.__file="pb-result-list.vue",t.default=c.exports},91:function(e,t,s){"use strict";var n=s(11);s.n(n).a},93:function(e,t,s){"use strict";s.r(t);var n=s(25),r=s(12);for(var i in r)"default"!==i&&function(e){s.d(t,e,function(){return r[e]})}(i);s(94);var u=s(0),c=Object(u.a)(r.default,n.a,n.b,!1,null,"f000d0ea",null);c.options.__file="pb-action-list.vue",t.default=c.exports},94:function(e,t,s){"use strict";var n=s(14);s.n(n).a},96:function(e,t,s){"use strict";s.r(t);var n=s(24),r=s(15);for(var i in r)"default"!==i&&function(e){s.d(t,e,function(){return r[e]})}(i);s(98);var u=s(0),c=Object(u.a)(r.default,n.a,n.b,!1,null,"493bb504",null);c.options.__file="pb-multi-list.vue",t.default=c.exports},97:function(e,t,s){"use strict";s.r(t);var n=s(27),r=s(17);for(var i in r)"default"!==i&&function(e){s.d(t,e,function(){return r[e]})}(i);var u=s(0),c=Object(u.a)(r.default,n.a,n.b,!1,null,null,null);c.options.__file="pb-multi-item.vue",t.default=c.exports},98:function(e,t,s){"use strict";var n=s(19);s.n(n).a}})});
//# sourceMappingURL=publicbody.js.map